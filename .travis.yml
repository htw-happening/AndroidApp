language: android
jdk: oraclejdk8
sudo: false

env:
  global:
    secure: iKaT88T6OHPGiukLsQsujBIKNjNzeJHL9MhKc0+AwucvgZ5Bu6Gm/pVeL9QTB3OoIsD3fV7XBWZ8TMCF0OccG6blXJqulCHPmmKM4rPMoBHWSazWj2/M47aWxObQFdu0kfso+lAHlw2l1NpiQc/5KR/pTPvDKpe75JNWl/tnJVxjeVq7Z/iv3c2eRa6ON9zjG25xjByWgru071BwS8swAf2hDQUxp2gmxVeBU4OPLwhs+VWqt67htmIAuagyqN01kdFTI4l60gdHJROWMyPcUKw1BFPygrUzbKuXc9UQRNP/jFMGuu9ceTchIZMzfeRx6VGtlA33eQHXDOQOb9i4oeYQPaVCn00/zSGoDyNhBaFHLQhszfTgVZoNru6PTvSEcNVajKA+CAcfxMr2efbb9chiGLZ+XI8Z6LSbReELObm/AtI6kGnIB1e02fHlvk2H/JrEP9MI14sJ+t4hYusRRnVuDwptP6Um0A2FmYkvqP5ihIhZl+nmcHK43bHOmDiNBLOgamoRpnT14NY9lpSIsC27MCvAvS922W3afbwgScoXejGmkAHq46EPi7ma7iEqiizo2xHsWZH2mkX9JK00xL3hAyEfizHO4gRD7k1CS7QgECsovVEZva29Dd7k2c6FgXDjOKgC0cz7lJwL62bq+fSfkCf9LYSrWcK5HVxZ/8M=

notifications:
  slack: happening-app:pMaPv1cJzgrR2fEOa6ExN9EL

android:
  components:
  - platform-tools
  - tools
  - build-tools-25.0.3
  - android-22
  - android-25
  - sys-img-armeabi-v7a-android-22
  - extra-android-m2repository

before_script:
- echo no | android create avd --force -n test -t android-22 --abi armeabi-v7a
- emulator -avd test -no-skin -no-audio -no-window &
- android-wait-for-emulator
- adb shell input keyevent 82 &

script:
- ./gradlew connectedAndroidTest
- ./gradlew publish
- ./gradlew javadoc

provider: script
  script: utility/javadoc-github-release.sh
  skip_cleanup: true
  on:
    branch: master